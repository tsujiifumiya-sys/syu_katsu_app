{% extends "base.html" %}
{% block title %}ESç®¡ç†{% endblock %}

{% block content %}
<div class="page-header">
    <h1>ğŸ“ ã‚¨ãƒ³ãƒˆãƒªãƒ¼ã‚·ãƒ¼ãƒˆç®¡ç†</h1>
    <a href="{{ url_for('main.es_new') }}" class="btn btn-primary">+ æ–°è¦è¿½åŠ </a>
</div>

{% if entry_sheets %}
<div class="es-table-wrapper">
    <table class="data-table">
        <thead>
            <tr>
                <th>ä¼æ¥­</th>
                <th>è¨­å•</th>
                <th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
                <th>æ–‡å­—æ•°</th>
                <th>ç· åˆ‡</th>
                <th>æ“ä½œ</th>
            </tr>
        </thead>
        <tbody>
            {% for es in entry_sheets %}
            <tr
                class="{% if es.deadline and es.status == 'ä¸‹æ›¸ã' %}{% set diff = (es.deadline - today).days if today else 999 %}{% if diff <= 3 %}deadline-urgent{% elif diff <= 7 %}deadline-soon{% endif %}{% endif %}">
                <td><span class="tag">{{ es.company.name }}</span></td>
                <td class="es-question">{{ es.question[:80] }}{% if es.question|length > 80 %}â€¦{% endif %}</td>
                <td>
                    <span class="status-badge status-{{ es.status }}">{{ es.status }}</span>
                </td>
                <td>
                    {% if es.char_limit %}
                    <span class="char-count {% if es.answer|length > es.char_limit %}over-limit{% endif %}">
                        {{ es.answer|length }} / {{ es.char_limit }}
                    </span>
                    {% else %}
                    <span class="char-count">{{ es.answer|length }} å­—</span>
                    {% endif %}
                </td>
                <td>
                    {% if es.deadline %}
                    {{ es.deadline.strftime('%m/%d') }}
                    {% else %}
                    <span class="text-muted">â€”</span>
                    {% endif %}
                </td>
                <td class="actions">
                    <a href="{{ url_for('main.es_edit', es_id=es.id) }}" class="btn btn-sm btn-ghost">âœï¸</a>
                    <form method="POST" action="{{ url_for('main.es_delete', es_id=es.id) }}" class="inline-form"
                        onsubmit="return confirm('å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')">
                        <button type="submit" class="btn btn-sm btn-danger-ghost">ğŸ—‘ï¸</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<div class="empty-state">
    <span class="empty-icon">ğŸ“</span>
    <p>ã¾ã ESãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“</p>
    <a href="{{ url_for('main.es_new') }}" class="btn btn-primary">æœ€åˆã®ESã‚’è¿½åŠ </a>
</div>
{% endif %}
{% endblock %}