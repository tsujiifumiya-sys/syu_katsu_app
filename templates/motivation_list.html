{% extends "base.html" %}
{% block title %}å¿—æœ›å‹•æ©Ÿç®¡ç†{% endblock %}

{% block content %}
<div class="page-header">
    <h1>ğŸ’Œ å¿—æœ›å‹•æ©Ÿç®¡ç†</h1>
    <a href="{{ url_for('main.motivation_new') }}" class="btn btn-primary">+ æ–°è¦è¿½åŠ </a>
</div>

{% set has_any = [] %}
{% for company in companies %}
{% if company.motivations %}
{% if has_any.append(1) %}{% endif %}
{% endif %}
{% endfor %}

{% if has_any %}
{% for company in companies %}
{% if company.motivations %}
<div class="section-card">
    <div class="section-card-header">
        <h2>ğŸ¢ {{ company.name }}</h2>
        <span class="preference-stars">{{ 'â˜…' * company.preference }}{{ 'â˜†' * (5 - company.preference) }}</span>
    </div>
    <div class="motivation-versions">
        {% for mot in company.motivations|sort(attribute='version', reverse=True) %}
        <div class="motivation-card">
            <div class="motivation-header">
                <div class="motivation-meta">
                    <span class="version-badge">v{{ mot.version }}</span>
                    <span class="tag">{{ mot.target_use or 'ES' }}</span>
                    <span class="text-muted">{{ mot.created_at.strftime('%Y/%m/%d') if mot.created_at else '' }}</span>
                </div>
                <div class="motivation-actions">
                    <a href="{{ url_for('main.motivation_edit', mot_id=mot.id) }}" class="btn btn-sm btn-ghost">âœï¸</a>
                    <form method="POST" action="{{ url_for('main.motivation_delete', mot_id=mot.id) }}"
                        class="inline-form" onsubmit="return confirm('å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')">
                        <button type="submit" class="btn btn-sm btn-danger-ghost">ğŸ—‘ï¸</button>
                    </form>
                </div>
            </div>
            <div class="motivation-content">
                <p>{{ mot.content }}</p>
            </div>
            {% if mot.review_notes %}
            <div class="motivation-review">
                <strong>ğŸ“Œ æ·»å‰Šãƒ¡ãƒ¢:</strong>
                <p>{{ mot.review_notes }}</p>
            </div>
            {% endif %}
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}
{% endfor %}
{% else %}
<div class="empty-state">
    <span class="empty-icon">ğŸ’Œ</span>
    <p>ã¾ã å¿—æœ›å‹•æ©ŸãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“</p>
    <a href="{{ url_for('main.motivation_new') }}" class="btn btn-primary">æœ€åˆã®å¿—æœ›å‹•æ©Ÿã‚’è¿½åŠ </a>
</div>
{% endif %}
{% endblock %}